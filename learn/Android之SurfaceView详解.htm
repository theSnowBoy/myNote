<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0064)http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml -->
<html xmlns="http://www.w3.org/1999/xhtml"><style type="text/css" id="10085578000"></style><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta content="360doc" name="classification">
    
    <link rel="alternate" media="only screen and (max-width: 640px)" href="http://www.360doc.cn/article/7724936_257842268.html">
    <meta content="surfaceview,surfaceholder,surface" name="keywords">
    <meta content="Android之SurfaceView详解" name="description">
    <meta name="mobile-agent" content="format=html5;url=http://www.360doc.cn/article/7724936_257842268.html">

    <meta content="www.360doc.com" name="author">

    <title>
        Android之SurfaceView详解
    </title>
    <link href="./Android之SurfaceView详解_files/bdsstyle.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="./Android之SurfaceView详解_files/jquery1.js"></script>
    <script type="text/javascript" src="./Android之SurfaceView详解_files/jQuery.md5.js"></script>
    
    <script type="text/javascript" language="javascript">
        window.onerror = ignoreError;
        function ignoreError() {
            return true;
        }
    </script>

    <link href="./Android之SurfaceView详解_files/wzhead-cleaned.css" rel="stylesheet" type="text/css">
    <link href="./Android之SurfaceView详解_files/wz20130912-cleaned.css" rel="stylesheet" type="text/css">


    

    <script type="text/javascript" src="./Android之SurfaceView详解_files/indexhead.js"></script><script type="text/javascript" src="./Android之SurfaceView详解_files/chat.js"></script><script type="text/javascript" src="./Android之SurfaceView详解_files/chatuserlist.js"></script><link rel="stylesheet" type="text/css" href="./Android之SurfaceView详解_files/chat.css">
    <script type="text/javascript" src="./Android之SurfaceView详解_files/showarticlefollow20130912.js"></script>
<link href="./Android之SurfaceView详解_files/bdsstyle(1).css" rel="stylesheet" type="text/css"><script type="text/javascript" src="./Android之SurfaceView详解_files/EssayforIE120425.js"></script></head>
<body style="font-family: Arial, Helvetica, sans-serif;" onmouseup="setDragEnd()" onmousemove="DragDiv();" onclick="delAllDiv(event)"><iframe frameborder="0" style="display: none;"></iframe><div id="bdshare_s" style="display: block;"><iframe id="bdsIfr" style="position:absolute;display:none;z-index:9999;" frameborder="0"></iframe><div id="bdshare_l" style="display: none;"><div id="bdshare_l_c"><h6>分享到</h6><ul><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_mshare mshare">一键分享</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_qzone qqkj">QQ空间</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_tsina xlwb">新浪微博</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_bdysc bdysc">百度云收藏</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_renren rrw">人人网</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_tqq txwb">腾讯微博</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_bdxc bdxc">百度相册</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_kaixin001 kxw">开心网</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_tqf txpy">腾讯朋友</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_tieba bdtb">百度贴吧</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_douban db">豆瓣网</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_tsohu shwb">搜狐微博</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_bdhome bdhome">百度新首页</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_sqq sqq">QQ好友</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_thx thx">和讯微博</a></li><li><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="bds_more">更多...</a></li></ul><p><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" class="goWebsite">百度分享</a></p></div></div></div>


    <span id="LayerLogin"></span>
    <div style="position: fixed; width: 100%; z-index: 1000;">
        <div class="mainnav">
            <div class="mainnav1">
                <div class="lf360" style="padding-left: 5px;">
                    <img src="./Android之SurfaceView详解_files/logoo.gif">
                </div>
                <div style="width: 625px; padding-top: 0px; padding-left: 4px; position: absolute;">
                    <table height="34" border="0" cellspacing="0" cellpadding="0">
                        <tbody>
                            <tr id="daohangtr">
                                <td style="width: 185px; _width: 0px; *width: 0px !important;"></td>
                                <td class="navwz1" width="95">
                                    <a href="http://www.360doc.com/index.html">首&nbsp;页</a>
                                </td>
                                <td width="100" class="  navwz1">
                                    <a href="http://www.360doc.com/readroom.html">阅览室</a>
                                </td>
                                <td width="88" class="  navwz1">
                                    <a href="http://www.360doc.com/weekstar.html">馆友</a>
                                </td>
                                <td width="132" class="  navwz1">
                                    <a href="http://www.360doc.com/my360doc.aspx">我的图书馆</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="rt360" style="padding-top: 6px; width: 133px; padding-left: 38px;" id="outerdiv"><div class="denglbj lan2"><div style="width: 43px; float: left; text-align: center; background-color: rgb(252, 252, 252);" onmouseover="this.style.backgroundColor=&#39;#e5e5e5&#39;;this.parentNode.className=&#39;denglbj2 lan2&#39;" onmouseout="this.style.backgroundColor=&#39;#fcfcfc&#39;;this.parentNode.className=&#39;denglbj lan2&#39;"><a href="javascript:void(0)" onclick="loginnew()">登录</a></div><div style=" width:1px; float:left; "></div><div style="width: 46px; float: left; text-align: center; margin-left: 1px; background-color: rgb(252, 252, 252);" onmouseover="this.style.backgroundColor=&#39;#e5e5e5&#39;;this.parentNode.className=&#39;denglbj3 lan2&#39;" onmouseout="this.style.backgroundColor=&#39;#fcfcfc&#39;;this.parentNode.className=&#39;denglbj lan2&#39;" id="regdiv"><a href="http://www.360doc.com/register.aspx?refer=800" target="_blank">注册</a></div><div class="boxwid xinngdui" id="bfdiv"><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#"><img id="imgbfabc" src="./Android之SurfaceView详解_files/5.gif"></a></div><div style="position: absolute; margin-left: 35px; width: 96px; z-index: 200; display: none;" id="func"><div class="tugduo3" id="divfunc" style="cursor:pointer;float:right; width:41px;"><div style=" height:26px; width:39px; border:1px solid #d4d4d4; border-bottom:none; background-color:#fff;"></div></div><div class="tipzhu3  right hui2" id="layerdiv"><ul><li><a href="http://www.360doc.com/advice.html" target="_blank">留言交流</a></li><li><a href="http://www.360doc.com/helpnew.html" target="_blank">网文摘手</a></li><li><a href="http://www.360doc.com/mobilapp.htm" target="_blank">手机客户端</a></li><li style=" border:none;"><a href="http://www.360doc.com/help.html" target="_blank">帮助</a></li></ul></div></div></div></div>
                <div class=" rt360" style="padding-top: 6px; padding-right: 0px;">
                    <div class="lf360 serch">
                        <input name="input2" class="serchpt" id="txtSearchword" onkeydown="ongosearch()" onkeyup="showIntelliSense()" onfocus="if(this.value==&#39;搜文章 找馆友&#39;) this.value=&#39;&#39;;this.style.color=&#39;#272727&#39;" onblur="if(!this.value) {this.value=&#39;搜文章 找馆友&#39;;this.style.color=&#39;#b2b2b2&#39;;}" onpaste="showIntelliSense1()" type="text" value="搜文章 找馆友">
                    </div>
                    <div class="lf360 ssuo">
                        <a id="searchlinkid" href="javascript:gosearch();"></a>
                    </div>
                    <div id="divsearch" style="margin-top: 25px; margin-left: 1px; display: none; position: absolute; z-index: 100;">
                    </div>
                </div>
            </div>
        </div>
        <div class="navxt">
        </div>
    </div>
    <div style="height: 44px; _height: 0px; width: 100%;"></div>

    <div class="both">
    </div>
    <div id="docTotalInfo" class="mainzt" style="width: 1047px;">
        <table class="index_main" border="0" cellpadding="0" cellspacing="0">
            <tbody>
                <tr>
                    <td align="left" valign="top" width="727px">
                        <div id="ADAboveArtContent"><iframe marginwidth="0" marginheight="0" frameborder="0" scrolling="no" width="728" height="90" src="./Android之SurfaceView详解_files/aboveConentAD2.htm"></iframe></div>
                        <div style="height: 7px;">
                        </div>
                        <table border="0" cellpadding="0" cellspacing="0" class="mainbj6" id="docArtClass">
                            <tbody>
                                <tr>
                                    <td>
                                        <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; text-align: center;">
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <table style="width: 100%; text-align: left;" border="0" cellpadding="0" cellspacing="0">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="biaoti">
                                                                        <div class="biaoti2 lf360">
                                                                            Android之SurfaceView详解
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="height: 32px;">


                                                                        <div style="width: 670px; height: 28px; padding-left: 26px; color: #777b7a;">
                                                                            <table>
                                                                                <tbody><tr>
                                                                                    <td>收藏人：<span class="name" onclick="wzhitnew(1);"><a href="http://www.360doc.com/userhome/7724936" target="_blank">神马玩意都有</a></span>
                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="btzctsg" id="spanfollowstatus"><div class="gzbt1"><a onclick="gzuser(7724936);wzhitnew(2);" href="javascript:void(0)"></a></div></div>
                                                                                        <script>isfollow(7724936);</script>

                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="ytdh1"><a onclick="doctalk();wzhitnew(106);" href="javascript:void(0)"></a></div>

                                                                                    </td>

                                                                                </tr>
                                                                            </tbody></table>
                                                                        </div>




                                                                        <div class="wztopxx">
                                                                            <div style="float: left; height: 28px; padding-top: 7px;">
                                                                                <table cellpadding="0" cellspacing="0" style="position: relative; z-index: 4">
                                                                                    <tbody>
                                                                                        <tr>

                                                                                            <td>
                                                                                                2013-01-03&nbsp;|&nbsp;阅：<span id="360doc_Readnum">10760</span>&nbsp;&nbsp;<span style="position: relative;">转：<span onclick="wzhitnew(3)" id="360doc_saverNum"><span style="cursor:pointer;" onclick="javascript:ShowSaverUser();">57</span></span><span id="360doc_saverUser"><div id="sameArtOuter" style="display: none; position: absolute; height: 305px; width: 144px; left: 0px; margin-top: 15px; z-index: 100000;"><div id="sameArt" style=" overflow-y: auto;  height:300px;overflow-x: hidden; z-index: 100;right:0px;margin-top:-10px;" onclick="event.cancelBubble=true;"></div></div></span></span>&nbsp;&nbsp;



                                                                                            </td>

                                                                                            <td>
                                                                                                <div style="position: relative;">
                                                                                                    &nbsp;|&nbsp;<span id="docsource">&nbsp;&nbsp;<a onclick="wzhitnew(14);" href="http://www.360doc.com/userhome/7724936" target="_blank">来源</a></span>
                                                                                                </div>
                                                                                                <div class="sekuaibox" style="display: none; margin-left: 48px;" id="zihaoboxID">
                                                                                                    <div style="padding-top: 10px; padding-left: 5px;">
                                                                                                        <div class="lf360 danxunbt">
                                                                                                            <input id="artdocfont3" onclick="ChangeArtSize(3, this); wzhitnew(15); " name="radio" type="radio" value="1">
                                                                                                        </div>
                                                                                                        <div class="lf360 danxunwz" onclick="ChangeArtSize(3,this);wzhitnew(15); " style="cursor: pointer;">
                                                                                                            大
                                                                                                        </div>
                                                                                                        <div class="lf360 danxunbt">
                                                                                                            <input id="artdocfont2" onclick="ChangeArtSize(2, this); wzhitnew(16); " name="radio" type="radio" value="2">
                                                                                                        </div>
                                                                                                        <div class="lf360 danxunwz" onclick="ChangeArtSize(2,this);wzhitnew(16); " style="cursor: pointer;">
                                                                                                            中
                                                                                                        </div>
                                                                                                        <div class="lf360 danxunbt">
                                                                                                            <input id="artdocfont1" onclick="ChangeArtSize(1, this); wzhitnew(17); " name="radio" type="radio" value="3">
                                                                                                        </div>
                                                                                                        <div class="lf360 danxunwz" onclick="ChangeArtSize(1,this);wzhitnew(17); " style="cursor: pointer;">
                                                                                                            小
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="sekuaibox" style="margin-left: 76px; display: none;" id="sekuaiboxID">
                                                                                                    <div style="padding-top: 10px; padding-left: 5px;">
                                                                                                        <img src="./Android之SurfaceView详解_files/cr1.gif" id="docArtC1" onclick="ChangeArtClass(1,this);wzhitnew(18);" style="cursor: pointer;"><img src="./Android之SurfaceView详解_files/cr2.gif" id="docArtC2" onclick="ChangeArtClass(2,this);wzhitnew(19);" style="cursor: pointer;"><img src="./Android之SurfaceView详解_files/cr3.gif" id="docArtC3" onclick="ChangeArtClass(3,this);wzhitnew(20);" style="cursor: pointer;"><img src="./Android之SurfaceView详解_files/cr4.gif" id="docArtC4" onclick="ChangeArtClass(4,this);wzhitnew(21);" style="cursor: pointer;"><img src="./Android之SurfaceView详解_files/cr5.gif" id="docArtC5" onclick="ChangeArtClass(5,this);wzhitnew(22);" style="cursor: pointer;"><img src="./Android之SurfaceView详解_files/cr6-1.gif" id="docArtC6" onclick="ChangeArtClass(6,this);wzhitnew(23);" style="cursor: pointer;">
                                                                                                    </div>
                                                                                                </div>
                                                                                            </td>
                                                                                            <td>
                                                                                                <div style="padding-left: 10px;">
                                                                                                    <a href="javascript:void(0)">
                                                                                                        <img onmouseover="changedivdisplay(1);" src="./Android之SurfaceView详解_files/wz1.gif"></a>
                                                                                                </div>
                                                                                            </td>
                                                                                            <td>
                                                                                                <div style="padding-left: 10px;" onmouseover="changedivdisplay(2);">
                                                                                                    <a href="javascript:void(0)">
                                                                                                        <img src="./Android之SurfaceView详解_files/wz2.gif"></a>
                                                                                                </div>
                                                                                            </td>
                                                                                            <td>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" onclick=" setTimeout(showShareLayer, 10);wzhitnew(4);">分享</a>&nbsp;</td>
                                                                                            <td>
                                                                                                <a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" onclick="  setTimeout(showShareLayer, 10);wzhitnew(5);">
                                                                                                    <img style="cursor: pointer;" src="./Android之SurfaceView详解_files/tb10.gif"></a><div class="fenxiang" id="fenxiangLayer" style="display: none; border: none; width: 110px; margin-left: -28px; _margin-left: -40px;"><div style="border:1px solid #cbcbcb; height:240px; width:108px;"><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare share-bar-btn"><table cellpadding="0" cellspacing="0" width="108" style=" background-color:#fff; "><tbody><tr><td width="12"></td><td height="29" onclick="wzhitnew(6);"><a class="bds_qzone" href="javascript:void(0);" title="分享到QQ空间">&nbsp;&nbsp;&nbsp;&nbsp;腾讯空间</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(9);"><a class="bds_tsina" href="javascript:void(0);" title="分享到新浪微博">&nbsp;&nbsp;&nbsp;&nbsp;新浪微博</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(10);"><a class="bds_tqq" href="javascript:void(0);" title="分享到腾讯微博">&nbsp;&nbsp;&nbsp;&nbsp;腾讯微博</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(7);"><a class="bds_renren" href="javascript:void(0);" title="分享到人人网">&nbsp;&nbsp;&nbsp;&nbsp;人人网</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(8);"><a class="bds_kaixin001" href="javascript:void(0);" title="分享到开心网">&nbsp;&nbsp;&nbsp;&nbsp;开心网</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(11);"><a class="bds_tsohu" href="javascript:void(0);" title="分享到搜狐微博">&nbsp;&nbsp;&nbsp;&nbsp;搜狐微博</a></td></tr><tr><td width="12"></td><td height="29"><a href="javascript:void(0);" onclick="showdivemail();wzhitnew(12);"><div class="bds_py">&nbsp;&nbsp;&nbsp;&nbsp;推荐给朋友</div></a></td></tr><tr><td width="12"></td><td height="29"><a href="javascript:void(0);"><div class="bds_jubao" onclick="showAlertLayer();wzhitnew(13);">&nbsp;&nbsp;&nbsp;&nbsp;举报</div></a></td></tr></tbody></table></div></div></div>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                            <div id="resavelayer1" class="rt360"><div class="zswdbtn1"><a href="javascript:void(0);" onclick="SaveArt();wzhitnew(24);"></a></div><div style="position: absolute;display:none;z-index:100000;" id="fuzhitishidiv"></div></div>


                                                                            <div id="shareweixinabove" class="rt360"> <div class="fxwx2bt"><a href="javascript:void(0);" onclick="shareWeixin();wzhitnew(65);"></a></div></div>


                                                                            <table cellpadding="0" cellspacing="0" style="text-align: center; margin: 0px auto;">
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td>
                                                                                            <div id="AlertArt1" style="display: none; position: absolute;">
                                                                                            </div>
                                                                                            <div id="SendToFriends1" style="display: none; position: absolute; z-index: 100;">
                                                                                            </div>
                                                                                            <div class="lf360 zcbutton" style="margin-left: 100px;">
                                                                                            </div>
                                                                                            <div class="lf360">
                                                                                                &nbsp;&nbsp;
                                                                                            </div>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        
                                                        <table class="wenzhangcss" border="0" cellpadding="0" cellspacing="0" width="100%">
                                                            <tbody>
                                                                <tr>
                                                                    <td>
                                                                        <div class="xiantao">
                                                                        </div>

                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" valign="top" width="670px" style="height: 200px;">
                                                                        <span id="articlecontent" onmousedown="newhighlight = true;" onmouseup="NewHighlight(event)" style="">
                                                                            <table>
                                                                                <tbody>
                                                                                    <tr>
                                                                                        <td width="670px" style="position: relative;">

                                                                                            <div>
<div style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; MARGIN-BOTTOM: 15px"><span style="LINE-HEIGHT: 26px; COLOR: rgb(255,153,102); FONT-SIZE: 18px"></span><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px"><strong><span style="COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 16px" color="#000000">SurfaceView介绍</font></span></strong></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">通常情况程序的View和用户响应都是在同一个线程中处理的，这也是为什么处理长时间事件（例如访问网络）需要放到另外的线程中去（防止阻塞当前UI线程的操作和绘制）。但是在其他线程中却不能修改UI元素，例如用后台线程更新自定义View（调用View的在自定义View中的onDraw函数）是不允许的。 如果需要在另外的线程绘制界面、需要迅速的更新界面或则渲染UI界面需要较长的时间，这种情况就要使用SurfaceView了。</font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">SurfaceView中包含一个Surface对象，而Surface是可以在后台线程中绘制的。Surface属于 OPhone底层显示系统。SurfaceView的性质决定了其比较适合一些场景：需要界面迅速更新、对帧率要求较高的情况。使用SurfaceView需要注意以下几点情况： SurfaceView和SurfaceHolder.Callback函数都从当前SurfaceView窗口线程中调用（一般而言就是程序的主线程）。有关资源状态要注意和绘制线程之间的同步。 在绘制线程中必须先合法的获取Surface才能开始绘制内容，在SurfaceHolder.Callback.surfaceCreated() 和SurfaceHolder.Callback.surfaceDestroyed()之间的状态为合法的，另外在Surface类型为SURFACE_TYPE_PUSH_BUFFERS时候是不合法的。 额外的绘制线程会消耗系统的资源，在使用SurfaceView的时候要注意这点。 </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">使用SurfaceView 只要继承SurfaceView类并实现SurfaceHolder.Callback接口就可以实现一个自定义的SurfaceView了，SurfaceHolder.Callback在底层的Surface状态发生变化的时候通知View，SurfaceHolder.Callback具有如下的接口： </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">surfaceCreated(SurfaceHolder holder)：当Surface第一次创建后会立即调用该函数。程序可以在该函数中做些和绘制界面相关的初始化工作，一般情况下都是在另外的线程来绘制界面，所以不要在这个函数中绘制Surface。 </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">surfaceChanged(SurfaceHolder holder, int format, int width,int height)：当Surface的状态（大小和格式）发生变化的时候会调用该函数，在surfaceCreated调用后该函数至少会被调用一次。 </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">surfaceDestroyed(SurfaceHolder holder)：当Surface被摧毁前会调用该函数，该函数被调用后就不能继续使用Surface了，一般在该函数中来清理使用的资源。 </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">通过SurfaceView的getHolder()函数可以获取SurfaceHolder对象，Surface 就在SurfaceHolder对象内。虽然Surface保存了当前窗口的像素数据，但是在使用过程中是不直接和Surface打交道的，由SurfaceHolder的Canvas lockCanvas()或则Canvas lockCanvas(Rect dirty)函数来获取Canvas对象，通过在Canvas上绘制内容来修改Surface中的数据。如果Surface不可编辑或则尚未创建调用该函数会返回null，在 unlockCanvas() 和 lockCanvas()中Surface的内容是不缓存的，所以需要完全重绘Surface的内容，为了提高效率只重绘变化的部分则可以调用lockCanvas(Rect dirty)函数来指定一个dirty区域，这样该区域外的内容会缓存起来。在调用lockCanvas函数获取Canvas后，SurfaceView会获取Surface的一个同步锁直到调用unlockCanvasAndPost(Canvas canvas)函数才释放该锁，这里的同步机制保证在Surface绘制过程中不会被改变（被摧毁、修改）。当在Canvas中绘制完成后，调用函数unlockCanvasAndPost(Canvas canvas)来通知系统Surface已经绘制完成，这样系统会把绘制完的内容显示出来。</font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">为了充分利用不同平台的资源，发挥平台的最优效果可以通过SurfaceHolder的setType函数来设置绘制的类型，目前接收如下的参数： </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">SURFACE_TYPE_NORMAL：用RAM缓存原生数据的普通Surface </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">SURFACE_TYPE_HARDWARE：适用于DMA(Direct memory access )引擎和硬件加速的Surface </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">SURFACE_TYPE_GPU：适用于GPU加速的Surface </font></font></span></span></div>
<div style="TEXT-ALIGN: left; MARGIN-BOTTOM: 15px" sizcache="1" sizset="27"><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><font style="BACKGROUND-COLOR: transparent; FONT-FAMILY: simsun; COLOR: rgb(51,51,51); FONT-SIZE: 13px">SURFACE_TYPE_PUSH_BUFFERS：表明该Surface不包含原生数据，Surface用到的数据由其他对象提供，在Camera图像预览中就使用该类型的Surface，有Camera负责提供给预览Surface数据，这样图像预览会比较流畅。如果设置这种类型则就不能调用lockCanvas来获取Canvas对象了。 </font></font></span></span><span style="TEXT-ALIGN: left" sizcache="1" sizset="27"><span style="LINE-HEIGHT: 26px; FONT-FAMILY: simsun; COLOR: rgb(255,153,102); FONT-SIZE: 13px"><span style="FONT-SIZE: 18px"><font style="FONT-SIZE: 14px" color="#000000"><wbr><wbr></font></span></span></span><span style="LINE-HEIGHT: 23px; FONT-FAMILY: simsun"></span></div><font style="FONT-SIZE: 14px" color="#000000"></font>
<div style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; MARGIN-BOTTOM: 15px; COLOR: rgb(51,51,51); FONT-SIZE: 13px"><span style="LINE-HEIGHT: 23px; FONT-FAMILY: simsun">使用的SurfaceView的时候，一般情况下还要对其进行创建，销毁，改变时的情况进行监视，这就要用到SurfaceHolder.Callback.</span></div>
<div style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51); FONT-SIZE: 13px">
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px">
</p><p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><span style="LINE-HEIGHT: 21px; FONT-FAMILY: simsun; COLOR: rgb(50,62,50)">只要继承SurfaceView类并实现SurfaceHolder.Callback接口就可以实现一个自定义的SurfaceView了，SurfaceHolder.Callback在底层的Surface状态发生变化的时候通知View，SurfaceHolder.Callback具有如下的接口：<br>surfaceCreated(SurfaceHolder holder)：当Surface第一次创建后会立即调用该函数。程序可以在该函数中做些和绘制界面相关的初始化工作，一般情况下都是在另外的线程来绘制界面，所以不要在这个函数中绘制Surface。 <br>surfaceChanged(SurfaceHolder holder, int format, int width,int height)：当Surface的状态（大小和格式）发生变化的时候会调用该函数，在surfaceCreated调用后该函数至少会被调用一次。 <br>surfaceDestroyed(SurfaceHolder holder)：当Surface被摧毁前会调用该函数，该函数被调用后就不能继续使用Surface了，一般在该函数中来清理使用的资源。 <br><br>通过SurfaceView的getHolder()函数可以获取SurfaceHolder对象，Surface 就在SurfaceHolder对象内。虽然Surface保存了当前窗口的像素数据，但是在使用过程中是不直接和Surface打交道的，由SurfaceHolder的Canvas lockCanvas()或则Canvas lockCanvas(Rect dirty)函数来获取Canvas对象，通过在Canvas上绘制内容来修改Surface中的数据。如果Surface不可编辑或则尚未创建调用该函数会返回null，在 unlockCanvas() 和 lockCanvas()中Surface的内容是不缓存的，所以需要完全重绘Surface的内容，为了提高效率只重绘变化的部分则可以调用lockCanvas(Rect dirty)函数来指定一个dirty区域，这样该区域外的内容会缓存起来。在调用lockCanvas函数获取Canvas后，SurfaceView会获取Surface的一个同步锁直到调用unlockCanvasAndPost(Canvas canvas)函数才释放该锁，这里的同步机制保证在Surface绘制过程中不会被改变（被摧毁、修改）。<br>当在Canvas中绘制完成后，调用函数unlockCanvasAndPost(Canvas canvas)来通知系统Surface已经绘制完成，这样系统会把绘制完的内容显示出来。为了充分利用不同平台的资源，发挥平台的最优效果可以通过SurfaceHolder的setType函数来设置绘制的类型，目前接收如下的参数：<br>SURFACE_TYPE_NORMAL：用RAM缓存原生数据的普通Surface <br>SURFACE_TYPE_HARDWARE：适用于DMA(Direct memory access )引擎和硬件加速的Surface <br>SURFACE_TYPE_GPU：适用于GPU加速的Surface <br>SURFACE_TYPE_PUSH_BUFFERS：表明该Surface不包含原生数据，Surface用到的数据由其他对象提供，在Camera图像预览中就使用该类型的Surface，有Camera负责提供给预览Surface数据，这样图像预览会比较流畅。如果设置这种类型则就不能调用lockCanvas来获取Canvas对象了。 </span></p>
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px">
</p><p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><span style="LINE-HEIGHT: 23px; FONT-FAMILY: simsun">访问SurfaceView的底层图形是通过SurfaceHolder接口来实现的，通过getHolder()方法可以得到这个SurfaceHolder对象。你应该实现surfaceCreated(SurfaceHolder)和surfaceDestroyed(SurfaceHolder)方法来知道在这个Surface在窗口的显示和隐藏过程中是什么时候创建和销毁的。</span></p>
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px">
</p><p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><span style="LINE-HEIGHT: 23px; FONT-FAMILY: simsun">注意：一个SurfaceView只在SurfaceHolder.Callback.surfaceCreated() 和 SurfaceHolder.Callback.surfaceDestroyed()调用之间是可用的，其他时间是得不到它的Canvas对象的（null）。</span></p>
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px">
</p><p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px">
</p><p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><strong></strong>&nbsp;</p>
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><strong>SurfaceView和View最本质的区别</strong></p>
<p style="PADDING-BOTTOM: 0px; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; PADDING-TOP: 0px"><span style="LINE-HEIGHT: 21px; FONT-FAMILY: arial"></span></p>
<div style="WIDTH: 794px">SurfaceView和View最本质的区别在于，surfaceView是在一个新起的单独线程中可以重新绘制画面而View必须在UI的主线程中更新画面。<br>那么在UI的主线程中更新画面 可能会引发问题，比如你更新画面的时间过长，那么你的主UI线程会被你正在画的函数阻塞。那么将无法响应按键，触屏等消息。<br>当使用surfaceView 由于是在新的线程中更新画面所以不会阻塞你的UI主线程。但这也带来了另外一个问题，就是事件同步。比如你触屏了一下，你需要surfaceView中thread处理，一般就需要有一个event queue的设计来保存touch event，这会稍稍复杂一点，因为涉及到线程同步。<br><br>所以基于以上，根据游戏特点，一般分成两类。<br><br>1 被动更新画面的。比如棋类，这种用view就好了。因为画面的更新是依赖于 onTouch 来更新，可以直接使用 invalidate。 因为这种情况下，这一次Touch和下一次的Touch需要的时间比较长些，不会产生影响。<br><br>2 主动更新。比如一个人在一直跑动。这就需要一个单独的thread不停的重绘人的状态，避免阻塞main UI thread。所以显然view不合适，需要surfaceView来控制。</div></div>
<div style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51); FONT-SIZE: 13px">&nbsp;</div>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px">周末看《精通Android游戏开发》(Pro Android Games)，里面讲到游戏的框架，其中一个重要的概念surfaceview,觉得不是很理解，于是花了一点时间研究了下，写下自己的心得。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px">surface，这个单词的意思是浮在表面的，那么surfaceview就是浮在表面的view了。如果真的这样解释，估计有人要拍砖了。然而，话虽不能这么说，取这个名儿，多少还是有点关系的。surface是一个可见区域。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>我们在屏幕上看到的这些view，在屏幕上看到的就是画面，在内存中就是一块内存区。绘图的时候，就是显示的硬件如显卡将内存区的这块图形数据绘制到屏幕上。所以，从内存的角度去看这些东西，会比较好理解。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>surface是surfaceview中的一个可见部分。我们知道，我们看到的屏幕上的图形，是二维的，我们看到的就是长和宽，其实，在内部实际上是三维的，另一个维度，就是层layer。我们用visio绘图，都会看到这种情况，一个图形会将另个图形遮住，是因为这个图形在上层。如果有同AutoCAD的经验，对这个更容易理解。我们看到的图形实际上是很多图形一层层的叠加在一起的，这些图形元素完全不可见，或者部分可见部分不可见，或者完全可见。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>这样看来，surface就可以这样理解：它是内存中一块区域，它是surfaceview可见不那个部分，绘图操作作用于它，然后它就会被显卡之类的显示控制器绘制到屏幕上。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>surface是个啥，大概已经有了些概念了。因为它对应了一个内存区，大家都知道，内存区的对象是有生命周期的，可以动态的申请创建和销毁，当然也可能会更新。于是，就有了作用于这个内存区的操作，这些操作就是surfaceCreated/Changed/Destroyed。三个操作放在一起，就是callback,<br>所以在很多例子里看到，会有callback。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>callback,是回调，意思是自己能干一些活，不过自己不去主动做，而是到别人那里去登记一下，别人需要的时候，就会叫我去做。就这个例子而言，可以打这个比方，某建筑工人队伍A，能盖房子，能装修，也能拆房子。可是他自己不去主动的做这些事情，而是去向开发商B去登记这三种能力，当然了，他把这三种能力打了包，叫做A的能力。啥时候，B有活干了，就叫A去做，或者是盖房子，或者是装修，或者是拆建筑。在这个例子中，能力包就是callback.</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>说了这个例子，其实就解释了 surface相关的一些东西，callback已经说过了，下面来说说其他的。假设surface就是一栋房子，那么surface拥有surfaceHolder，谁呢？在这个例子中好比建筑队A。盖房子对应的就是surfaceCreated, 拆房子就对应了surfaceDestroyed，装修就对应了surfaceChanged.</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>surface有生存期，好比房子有生存期，在建造以后就存在，在拆了之后就没有了。装修必须发生在这之间。同样的，surface的change必须发生在created和destroyed之间。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>surfaceview知道surface的holder是谁，在surfaceview生成的时候，会调用getHolder得到holder，然后holder会调用addCallback将三个callback函数注册。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>holder拥有对于surface的控制权。在很多程序中，会在surfaceCreated的函数实现中创建另一个线程。所以在这里有两个线程，一个是UI线程，另一个负责画图的线程。画图线程由UI线程调用surfaceCreated的时候创建，在surfaceDestroyed调用的时候放回到线程池。在这中间，画图线程负责图形的绘制。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>在这种模型下，UI线程和画图线程各司其职，前者主要负责和用户的交互，而后者，在负责绘制图形。这样，绘制图形的时候如果时间较长，不会阻塞用户的输入。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>我们知道，线程共享内存数据，所以， surface对于两个线程是共享的。所以，为了避免在画图的时候，UI线程也对surface进行操作，在画图前，需要对surface加锁。这个工作是有holder干的，holder会先锁住surface中的一块holder.lockCanvas，我们叫canvas,然后，在上面绘画，画完之后，会解锁unlockCanvasAndPost。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>在 应用中，画图可以是一次性的，也可以是由定时器触发的定时的画。实现的都是runnable类中的run方法。关于runnable类，这个Java中定义的，并不是android独有的，可以参考Java的referrence.</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>这个模型最大的好处就是，画图不依赖于UI线程，不会阻塞UI线程。<br>而单纯的view是依赖于UI线程画图的。对于完全依赖于用户的输入进行图像显示的更新的，用view是可以的，但是如果能够自动的进行绘图，而不需等待用户的输入，surfaceview无疑是更好的选择。</p>
<p style="PADDING-BOTTOM: 0px; LINE-HEIGHT: 28px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN-TOP: 0px; FONT-FAMILY: 宋体; MARGIN-BOTTOM: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; COLOR: rgb(51,51,51); FONT-SIZE: 13px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px"><br>有图有真相，请看图<img style="PADDING-BOTTOM: 0px; BORDER-RIGHT-WIDTH: 0px; LIST-STYLE-TYPE: none; MARGIN: 0px; PADDING-LEFT: 0px; WIDTH: 630px; PADDING-RIGHT: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 378px; BORDER-LEFT-WIDTH: 0px; PADDING-TOP: 0px" alt="\" src="./Android之SurfaceView详解_files/29354570_1.png"><br></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"></span></span></span>&nbsp;</p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">在android中开发游戏，一般来说，或想写一个复杂一点的游戏，是必须用到SurfaceView来开发的。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">经过这一阵子对android的学习，我找到了自已在android中游戏开发的误区，不要老想着用Layout和view去实现，不要将某个游戏</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">中的对象做成一个组件来处理。应该尽量想着在Canvas(画布)中画出游戏戏中的背景、人物、动画等...</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceView提供直接访问一个可画图的界面，可以控制在界面顶部的子视图层。SurfaceView是提供给需要直接画像素而不是使用</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">窗体部件的应用使用的。Android图形系统中一个重要的概念和线索是surface。View及其子类（如TextView, Button）</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">要画在surface上。每个surface创建一个Canvas对象（但属性时常改变），用来管理view在surface上的绘图操作，如画点画线。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">还要注意的是，使用它的时候，一般都是出现在最顶层的：The view hierarchy will take care of correctly compositing</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">with the Surface any siblings of the SurfaceView that would normally appear on top of it.</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">使用的SurfaceView的时候，一般情况下还要对其进行创建，销毁，改变时的情况进行监视，这就要用到SurfaceHolder.Callback.</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">class BBatt extends SurfaceView implements SurfaceHolder.Callback {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceChanged(SurfaceHolder holder,int format,int width,int height){}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//看其名知其义，在surface的大小发生改变时激发</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceCreated(SurfaceHolder holder){}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//同上，在创建时激发，一般在这里调用画图的线程。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceDestroyed(SurfaceHolder holder) {}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//同上，销毁时激发，一般在这里将画图的线程停止、释放。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">例子：</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public class BBatt extends SurfaceView implements</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceHolder.Callback, OnKeyListener {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">private BFairy bFairy;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">private DrawThread drawThread;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public BBatt(Context context) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">super(context);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">this.setLayoutParams(</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">new ViewGroup.LayoutParams(</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">Global.battlefieldWidth, Global.battlefieldHeight));</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">this.getHolder().addCallback( this );</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">this.setFocusable( true );</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">this.setOnKeyListener( this );</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">bFairy = new BFairy(this.getContext());</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceChanged(SurfaceHolder holder,</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">int format,int width,int height) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">drawThread = new DrawThread(holder);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">drawThread.start();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceDestroyed(SurfaceHolder holder) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">if( drawThread != null ) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">drawThread.doStop();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">while (true) try {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">drawThread.join();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">break ;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">} catch(Exception ex) {}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public boolean onKey(View view, int keyCode, KeyEvent event) {}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">实例2:用线程画一个蓝色的长方形。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">package com.g3.test;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">/*</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">* SurfaceView的示例程序</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">* 演示其流程</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">*/</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.app.Activity;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.content.Context;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Canvas;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Color;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Paint;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.RectF;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.os.Bundle;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.view.SurfaceHolder;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.view.SurfaceView;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public class Test extends Activity {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void onCreate(Bundle savedInstanceState) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">super.onCreate(savedInstanceState);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">setContentView(new MyView(this));</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//内部类</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">class MyView extends SurfaceView implements SurfaceHolder.Callback{</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceHolder holder;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public MyView(Context context) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">super(context);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">holder = this.getHolder();//获取holder</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">holder.addCallback(this);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//setFocusable(true);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceChanged(SurfaceHolder holder, int format, int width,</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">int height) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceCreated(SurfaceHolder holder) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">new Thread(new MyThread()).start();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceDestroyed(SurfaceHolder holder) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//内部类的内部类</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">class MyThread implements Runnable{</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void run() {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">Canvas canvas = holder.lockCanvas(null);//获取画布</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">Paint mPaint = new Paint();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mPaint.setColor(Color.BLUE);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">canvas.drawRect(new RectF(40,60,80,80), mPaint);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">holder.unlockCanvasAndPost(canvas);//解锁画布，提交画好的图像</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">访问SurfaceView的底层图形是通过SurfaceHolder接口来实现的，通过getHolder()方法可以得到这个SurfaceHolder对象。你应该实现surfaceCreated(SurfaceHolder)和surfaceDestroyed(SurfaceHolder)方法来知道在这个Surface在窗口的显示和隐藏过程中是什么时候创建和销毁的。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceView可以在多线程中被访问。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">注意：一个SurfaceView只在SurfaceHolder.Callback.surfaceCreated() 和 SurfaceHolder.Callback.surfaceDestroyed()调用之间是可用的，其他时间是得不到它的Canvas对象的（null）。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">我的访问过程：</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">创建一个SurfaceView的子类，实现SurfaceHolder.Callback接口。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">得到这个SurfaceView的SurfaceHolder对象holder。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">holder.addCallback(callback)，也就是实现SurfaceHolder.Callback接口的类对象。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">在SurfaceHolder.Callback.surfaceCreated()调用过后holder.lockCanvas()对象就可以得到SurfaceView对象对应的Canvas对象canvas了。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">用canvas对象画图。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">画图结束后调用holder.unlockCanvasAndPost()就把图画在窗口中了。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceView可以多线程访问，在多线程中画图。</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.content.Context;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Canvas;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Color;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.graphics.Paint;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.util.Log;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.view.SurfaceHolder;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">import android.view.SurfaceView;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public class MySurfaceView extends SurfaceView implements</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">SurfaceHolder.Callback {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">private Context mContext;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">private SurfaceHolder mHolder;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public TouchScreenAdjusterSurfaceView(Context context,) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">super(context);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mContext = context;</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mHolder = TouchScreenAdjusterSurfaceView.this.getHolder();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mHolder.addCallback(TouchScreenAdjusterSurfaceView.this);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">this.setFocusableInTouchMode(true); // to make sure that we can get</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// touch events and key events,and</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// "setFocusable()" to make sure we</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// can get key events</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceChanged(SurfaceHolder holder, int format, int width,</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">int height) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// TODO Auto-generated method stub</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceCreated(SurfaceHolder holder) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">//now you can get the Canvas and draw something here</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">@Override</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void surfaceDestroyed(SurfaceHolder holder) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// TODO Auto-generated method stub</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">public void drawMyShape(PointPostion ps) {</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mCanvas = mHolder.lockCanvas();</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">// draw anything you like</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">mHolder.unlockCanvasAndPost(mCanvas);</span><br style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="TEXT-ALIGN: left; LINE-HEIGHT: 26px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">}</span><br></span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><br></span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><br></span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><br></span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px"><br></span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">如何让 SurfaceView 响应事件</span></span></p>
<p><span style="TEXT-ALIGN: center; LINE-HEIGHT: 18px; FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"></span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">当然创建你自己的类时，你还是得extends SurfaceView and implements Callback接口，</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">然后在构造函数里设置一个属性</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">this.setLongClickable(true);//这里很重要，它是让你的设备支持长按效果的属性，如果它为false 的时候MotionEvent 只能监听到ACTION_DOWN这个事件。</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">上面准备好后就可以重写 onTouchEvent方法了！！</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">@Override</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">public boolean onTouchEvent(MotionEvent event)</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">{</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">switch(event.getAction()){</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">case MotionEvent.ACTION_DOWN:</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">Log.d("MotionEvent", "ACTION_DOWN");</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">break;</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">case MotionEvent.ACTION_UP:</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">Log.d("MotionEvent", "ACTION_UP");</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">break;</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">case MotionEvent.ACTION_MOVE:</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">Log.d("MotionEvent", "ACTION_MOVE");</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">break;</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)">
</p><p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">}</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">return super.onTouchEvent(event);</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">}</span></p>
<p style="FONT-FAMILY: Arial; COLOR: rgb(51,51,51)"><span style="FONT-SIZE: 13px">调试一下看看吧！！</span></p></div>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                            <div id="viewerPlaceHolder" style="width: 717px; height: 700px; display: none;">
                                                                            </div>
                                                                        </span>
                                                                        <table>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left">
                                                                        <a name="anchordoc1" id="anchordoc1"></a>
                                                                        <div style="height: 28px">
                                                                            <div style="font-size: 14px; color: #797b7a; float: left;">
                                                                                来自：<span class="name" onclick="wzhitnew(59)"><a href="http://www.360doc.com/userhome/7724936" target="_blank">神马玩意都有</a></span>&nbsp;&gt;&nbsp;<span id="cname" onclick="wzhitnew(60)"><a href="http://www.360doc.com/userhome.aspx?userid=7724936&cid=44" target="_blank">《Surfaceview》</a></span>
                                                                            </div>
                                                                            <div style="float: left;">
                                                                                <div class="btzctsg" id="spanfollowstatus1"><div class="gzbt1"><a onclick="gzuser(7724936);wzhitnew(61);" href="javascript:void(0)"></a></div></div>
                                                                                <script>isfollow(7724936);</script>

                                                                            </div>
                                                                            <div style="float: left;">
                                                                                <div class="ytdh1"><a onclick="doctalk();wzhitnew(107);" href="javascript:void(0)"></a></div>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div class="modlist lf360 list" style="padding-top: 0px;">
                                                                                <ul>
                                                                                    <div id="lastart">
                                                                                    </div>
                                                                                    <div id="nextart">
                                                                                    </div>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left">
                                                                        <div style="padding-top: 12px;">
                                                                            <div id="docAdBelowContent"><iframe marginwidth="0" marginheight="0" frameborder="0" scrolling="no" width="650" height="120" src="./Android之SurfaceView详解_files/docAdBelowContent1.htm"></iframe></div>

                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td style="text-align: left;">
                                                                        <div style="padding-top: 15px; width: 670px;">
                                                                            <table style="width: 670px;" cellpadding="0" cellspacing="0">
                                                                                <tbody>
                                                                                    <tr>

                                                                                        <td style="width: 530px;">
                                                                                            <div class=" lf360" style="cursor: pointer" onmouseover="ChangeBtnStyle(1);" onmouseout="ChangeBtnStyle(2);">
                                                                                                <div class="zscbt">
                                                                                                    <a href="javascript:void(0);" onclick="SaveArt();wzhitnew(26);">
                                                                                                        <div id="zscbtword" class="lf360 xianhua" style="padding-left: 38px;">
                                                                                                            转藏到我的图书馆
                                                                                                        </div>
                                                                                                    </a>
                                                                                                </div>
                                                                                            </div>

                                                                                            <div style="margin-left: 10px; cursor: pointer;" class="lf360 xhmainbox" id="sendflowerdiv" onclick="Showflowerlayer(&quot;sendedLayer1&quot;);wzhitnew(27)" onmouseover="ChangeFlowerBtnStyle(1);" onmouseout="ChangeFlowerBtnStyle(2);">

                                                                                                <div id="flowimg2" class="lf360">
                                                                                                    <div style="padding-left: 10px; padding-top: 10px;">
                                                                                                        <img id="flowimg3" src="./Android之SurfaceView详解_files/huahuanew.gif">
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div id="flowimg5" class=" lf360 xianhua">
                                                                                                    献花(<span id="articleflowernum">1</span>)<div id="flowernumadd" class="addtionone">
                                                                                                        +1
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>




                                                                                            <div class="lf360" style="cursor: pointer; padding-left: 10px;" onmouseover="ChangeBtnStyle(3);" onmouseout="ChangeBtnStyle(4);">
                                                                                                <div class="fxwxbt">

                                                                                                    <a href="javascript:void(0);" onclick="shareWeixin();wzhitnew(64);">
                                                                                                        <div id="fxwxword" class="lf360 xianhua" style="padding-left: 38px;">
                                                                                                            分享到微信
                                                                                                        </div>
                                                                                                    </a>
                                                                                                </div>
                                                                                            </div>





                                                                                            <div class="lf360" style="cursor: pointer; padding-left: 10px;" onmouseover="ChangeBtnStyle(5);" onmouseout="ChangeBtnStyle(6);">
                                                                                                <div class="ywzwbt">

                                                                                                    <a id="ywzwa" href="http://www.baidu.com/s?wd=surfaceview+surfaceholder+surface&tn=SE_hldp01010_6r0gix1f" onclick="wzhitnew(100);" target="_blank">
                                                                                                        <div id="ywzwword" class="lf360 xianhua" style="padding-left: 44px;">
                                                                                                            以文找文
                                                                                                        </div>
                                                                                                    </a>

                                                                                                </div>
                                                                                            </div>
                                                                                        </td>
                                                                                        <td style="vertical-align: bottom; font-size: 12px;" width="140">
                                                                                            <div class="rt360" id="sharediv2"><table style=" vertical-align: text-bottom;" border="0" cellpadding="0" cellspacing="0"> <tbody><tr><td><div style="height:20px; width:105px;"><div style="float:left;"><span style="font-size:12px; line-height:16px; color:#959595;">分享：</span></div><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare share-bar-btn2" style="float:left;"><span onclick="wzhitnew(28);"><a class="bds_qzone" title="分享到QQ空间" href="javascript:void(0);"></a></span><span onclick="wzhitnew(31);"><a class="bds_tsina" title="分享到新浪微博" href="javascript:void(0);"></a></span><span onclick="wzhitnew(32);"><a class="bds_tqq" title="分享到腾讯微博" href="javascript:void(0);"></a></span></div></div></td><td width="24"><a><img style="cursor:pointer;" src="./Android之SurfaceView详解_files/tb10.gif" onclick="setTimeout(showShareLayer2, 10);wzhitnew(34);"></a><div id="fenxiangLayer1" class="fenxiang" style=" margin-left:-100px;*margin-left:-120px!important; margin-top:5px;*margin-top:16px!important;display:none;z-index:1000;"><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare share-bar-btn"><table cellpadding="0" cellspacing="0" width="108" style=" background-color:#fff; "><tbody><tr><td width="12"></td><td height="29" onclick="wzhitnew(29);"><a class="bds_renren" href="javascript:void(0);" title="分享到人人网">&nbsp;&nbsp;&nbsp;&nbsp;人人网</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(30);"><a class="bds_kaixin001" href="javascript:void(0);" title="分享到开心网">&nbsp;&nbsp;&nbsp;&nbsp;开心网</a></td></tr><tr><td width="12"></td><td height="29" onclick="wzhitnew(33);"><a class="bds_tsohu" href="javascript:void(0);" title="分享到搜狐微博">&nbsp;&nbsp;&nbsp;&nbsp;搜狐微博</a></td></tr><tr><td width="12"></td><td height="29"><a href="javascript:void(0);" onclick="showdivemail1();wzhitnew(35);"><div class="bds_py">&nbsp;&nbsp;&nbsp;&nbsp;推荐给朋友</div></a></td></tr><tr><td width="12"></td><td height="29"><a href="javascript:void(0);"><div class="bds_jubao" onclick="showAlertLayer1();wzhitnew(36);">&nbsp;&nbsp;&nbsp;&nbsp;举报</div></a></td></tr></tbody></table></div></div></td></tr></tbody></table><div id="AlertArt2" style="display:none; position:absolute;"></div><div id="SendToFriends2" style="display:none;position:absolute;z-index:1000;"></div></div>
                                                                                        </td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td height="10"></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="lswzbox" style="padding-top: 10px;">
                            <div>
                                <table cellpadding="0" cellspacing="0">
                                    <tbody>
                                        <tr>
                                            <td width="330" valign="top">
                                                <div class="lswz" style="height: 300px;">
                                                    <div class="lstwtop">
                                                        <div class="lswztit">
                                                            <div class=" lf360">
                                                                <div class="titwx1">
                                                                    类似文章
                                                                </div>
                                                            </div>
                                                            <div class="rt360" style="padding-top: 5px; padding-right: 9px;">
                                                                <a href="http://www.360doc.com/relevant/257842268_more.shtml" target="_blank" onclick="wzhitnew(38)">更多</a>
                                                            </div>
                                                        </div>
                                                        <div class="modlist2 list">
                                                            <ul>
                                                                
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/11/0608/00/6695445_122356125.shtml" target="_blank" onclick="wzhitnew(37)">【Android2D游戏开发之二】剖析游戏开发...</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/13/1117/18/14479769_330027854.shtml" target="_blank" onclick="wzhitnew(37)">Android游戏框架SurfaceView介绍（附代码....</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/10/1201/10/4446968_73949145.shtml" target="_blank" onclick="wzhitnew(37)">Android实例剖析笔记（八）_知识库_博客...</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/12/0117/15/5087210_180003171.shtml" target="_blank" onclick="wzhitnew(37)">Android多媒体学习十二：Android中Video...</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/12/1115/18/10388890_248047362.shtml" target="_blank" onclick="wzhitnew(37)">如何实现Android SurfaceView</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/10/1116/16/3234041_69865756.shtml" target="_blank" onclick="wzhitnew(37)">Android中在SurfaceView上高效绘图_fqli...</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/10/1109/18/1290342_67977334.shtml" target="_blank" onclick="wzhitnew(37)">MediaPlayer 用法(一) - 一切皆有可能 -...</a></span></li>
                                                                    
                                                                        <li style="height: 30px; line-height: 30px;"><span>
                                                                            <a href="http://www.360doc.com/content/13/1127/10/97538_332504856.shtml" target="_blank" onclick="wzhitnew(37)">实现自己的Camera</a></span></li>
                                                                    
                                                            </ul>
                                                        </div>

                                                    </div>
                                                </div>
                                            </td>

                                            <td width="330" valign="top">
                                                <div class="lswz" style="margin-left: 9px; height: 300px;">
                                                    <div class="lstwtop">
                                                        <div class="lswztit">
                                                            <div class=" lf360">
                                                                <div class="titwx1">
                                                                    热搜文章
                                                                </div>
                                                            </div>
                                                            <div class="rt360" style="padding-top: 5px; padding-right: 9px;">
                                                            </div>
                                                        </div>
                                                        <div class="modlist2 list">
                                                            <ul> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e5%be%ae%e6%83%85%e4%b9%a6%3a%e4%ba%ba%e7%94%9f%e5%a6%82%e5%90%8c%e6%95%85%e4%ba%8b%2c%e9%87%8d%e8%a6%81%e7%9a%84%e5%b9%b6%e4%b8%8d%e5%9c%a8%e4%ba%8e%e6%9c%89%e5%a4%9a%e9%95%bf%2c%e8%80%8c%e5%9c%a8%e4%ba%8e%e6%9c%89%e5%a4%9a%e5%a5%bd&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)" title="微情书:人生如同故事,重要的并不在于有多长,而在于有多好">微情书:人生如同故事,重要的并不在于有多...</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e4%ba%92%e8%81%94%e7%bd%91%e6%80%9d%e7%bb%b4%e5%b7%b2%e7%bb%8f%e5%bd%bb%e5%ba%95%e6%94%b9%e5%8f%98%e4%ba%86%e9%82%a3%e4%ba%9b%e5%8e%9f%e6%9d%a5%e8%a2%ab%e5%ae%9a%e6%ad%bb%e5%81%9a%e6%b3%95%e5%a5%97%e8%b7%af%e7%9a%84%e8%a1%8c%e4%b8%9a&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)" title="互联网思维已经彻底改变了那些原来被定死做法套路的行业">互联网思维已经彻底改变了那些原来被定死...</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e6%8a%8a%e6%80%9d%e7%bb%b4%e4%bb%b7%e5%80%bc%e8%bd%ac%e6%8d%a2%e6%88%90%e4%ba%86%e7%bb%8f%e6%b5%8e%e4%bb%b7%e5%80%bc%ef%bc%9a%e5%8a%a0%e4%b8%80%e4%b8%aa%e9%b8%a1%e8%9b%8b%ef%bc%8c%e8%bf%98%e6%98%af%e5%8a%a0%e4%b8%a4%e4%b8%aa%e9%b8%a1%e8%9b%8b%ef%bc%9f&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)" title="把思维价值转换成了经济价值：加一个鸡蛋，还是加两个鸡蛋？">把思维价值转换成了经济价值：加一个鸡蛋...</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e5%8f%b2%e8%b0%a2%e8%99%b9%ef%bc%9a%e5%8b%83%e5%88%97%e6%97%a5%e6%b6%85%e5%a4%ab%e7%9a%84%e5%96%9c%e5%89%a7%e5%92%8c%e5%a4%a7%e5%9b%bd%e7%9a%84%e6%82%b2%e5%89%a7&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)">史谢虹：勃列日涅夫的喜剧和大国的悲剧</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e8%a2%ab%e5%86%a4%e6%9e%89%e4%ba%86%e4%b8%a4%e5%8d%83%e5%a4%9a%e5%b9%b4%e7%9a%84%e7%99%bb%e5%be%92%e5%ad%90&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)">被冤枉了两千多年的登徒子</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e6%b0%91%e5%9b%bd%e7%8b%82%e5%a3%ab%e7%9a%84%e7%8b%82%e6%94%be%e4%b8%8e%e6%80%aa%e5%bc%82%ef%bc%8c%e4%bb%96%e4%bb%ac%e7%9a%84%e6%89%8d%e5%ad%a6%e4%b8%8e%e6%b0%94%e8%b4%a8%ef%bc%8c%e5%90%8e%e4%ba%ba%e5%86%8d%e9%9a%be%e4%bb%a5%e4%bc%81%e5%8f%8a&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)" title="民国狂士的狂放与怪异，他们的才学与气质，后人再难以企及">民国狂士的狂放与怪异，他们的才学与气质...</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e7%a4%be%e4%bc%9a%e7%9a%84%e9%98%b4%e6%9a%97%e9%9d%a2%e2%80%94%e4%b8%ad%e5%9b%bd%e5%a6%93%e5%a5%b3%2f%e5%b0%8f%e5%a7%90%e4%b8%8a%e7%94%b5%e8%a7%86%e8%bf%b0%e8%be%9b%e9%85%b8%e5%8f%b2%ef%bc%9a%e6%80%95%e9%a6%99%e6%b8%af%e5%ae%a2%e4%ba%ba&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)" title="社会的阴暗面—中国妓女/小姐上电视述辛酸史：怕香港客人">社会的阴暗面—中国妓女/小姐上电视述辛酸...</a></span></li> <li style="height: 30px; line-height: 30px;"><span><a href="http://www.baidu.com/s?wd=%e8%b6%81%e7%9d%80%e5%b9%b4%e8%bd%bb%ef%bc%8c%e7%bb%99%e8%87%aa%e5%b7%b1%e4%b8%80%e4%b8%aa%e7%89%9b%e9%80%bc%e7%9a%84%e6%9c%ba%e4%bc%9a&tn=SE_hldp01010_6r0gix1f" target="_blank" onclick="wzhitnew(106)">趁着年轻，给自己一个牛逼的机会</a></span></li></ul>
                                                        </div>

                                                    </div>
                                                </div>
                                            </td>

                                        </tr>
                                    </tbody>
                                </table>
                                <div style="background-color: #fafafa; width: 670px; height: 317px; margin-top: 10px;">
                                    <div style=" padding-top:7px; padding-left:12px; height:182px;"> <div style=" height:30px;"><div class="titwx3 lf360">猜你喜欢</div><div class=" rt360" style=" padding-right:18px;"><img onclick="changefiveart(&quot;19999&quot;,&quot;19999&quot;);wzhitnew(62);" src="./Android之SurfaceView详解_files/hyz.gif" onmouseover="this.src=&quot;http://pubimage.360doc.com/wz/hyza.gif&quot;" onmouseout="this.src=&quot;http://pubimage.360doc.com/wz/hyz.gif&quot;" width="76" height="24" style="cursor:pointer;"></div></div><table cellpadding="0" cellspacing="0"><tbody><tr id="fivearttdid"><td valign="top" width="131"><div><a onclick="wzhitnew(39);" href="http://www.360doc.com/content/13/0629/10/9774604_296301722.shtml" target="_blank"><img src="./Android之SurfaceView详解_files/9774604_201308281738020353.jpg" width="114" height="86"></a></div><div class="lan twentit"><a onclick="wzhitnew(40);" href="http://www.360doc.com/content/13/0629/10/9774604_296301722.shtml" target="_blank">精明商人八大特征</a></div></td><td valign="top" width="131"><div><a onclick="wzhitnew(39);" href="http://www.360doc.com/content/14/0410/09/2283188_367684908.shtml" target="_blank"><img src="./Android之SurfaceView详解_files/367684908_201405120252090618.jpg" width="114" height="86"></a></div><div class="lan twentit"><a onclick="wzhitnew(40);" href="http://www.360doc.com/content/14/0410/09/2283188_367684908.shtml" target="_blank">蒸鱼去腥最关键的一步</a></div></td><td valign="top" width="131"><div><a onclick="wzhitnew(39);" href="http://www.360doc.com/content/09/0313/11/110885_2795377.shtml" target="_blank"><img src="./Android之SurfaceView详解_files/110885_201404020010250201.jpg" width="114" height="86"></a></div><div class="lan twentit"><a onclick="wzhitnew(40);" href="http://www.360doc.com/content/09/0313/11/110885_2795377.shtml" target="_blank">夏日冰沙 冷饮制作</a></div></td><td valign="top" width="131"><div><a onclick="wzhitnew(39);" href="http://www.360doc.com/content/13/0530/16/865028_289249815.shtml" target="_blank"><img src="./Android之SurfaceView详解_files/865028_201310290010070539.jpg" width="114" height="86"></a></div><div class="lan twentit"><a onclick="wzhitnew(40);" href="http://www.360doc.com/content/13/0530/16/865028_289249815.shtml" target="_blank">魔道之争-抗美援朝战争中双方坑道攻防...</a></div></td><td valign="top" width="131"><div><a onclick="wzhitnew(39);" href="http://www.360doc.com/content/14/0210/13/9121025_351325737.shtml" target="_blank"><img src="./Android之SurfaceView详解_files/9121025_201402160010150197.jpg" width="114" height="86"></a></div><div class="lan twentit"><a onclick="wzhitnew(40);" href="http://www.360doc.com/content/14/0210/13/9121025_351325737.shtml" target="_blank">你真知道百年粥店的秘密吗</a></div></td></tr></tbody></table></div>
                                    <div style="padding-left: 12px;">
                                        <iframe marginwidth="0" marginheight="0" frameborder="0" scrolling="no" width="650" height="100" src="./Android之SurfaceView详解_files/artadali4.htm"></iframe>
                                    </div>
                                    <div id="adabtest" style="display: none;">
                                    </div>

                                </div>





                                <div id="Reflction" style="padding-top: 15px; padding-left: 15px;">
                                    <div id="360docRefTN" style="display: none;"></div>
                                    <div id="360docRefCT"></div>
                                    <div id="360docRefPB" align="center" style="display: none;"></div>
                                </div>
                                <a name="sf"></a>
                                
                                <div id="ReflectionPart"><div style=" height:206px; margin:0px 0px;"><div class="plbox"><div class="plmain"><div class="titwx" style=" height:23px;">发表评论：</div><div class="deluwx">您好，请&nbsp;<span><a href="javascript:void(0);" onclick="ReflectionLoginform();wzhitnew(45);">登录</a></span>&nbsp;或者&nbsp;<span><a href="http://www.360doc.com/register.aspx?refer=53&reurl=showweb/0/0/257842268.aspx" onclick="InsertLogData(4);wzhitnew(46);">注册</a></span>&nbsp;后再进行评论 </div><div class=" rt360"><div style=" float:left; color:#959595; width:90px; "><div style="padding-top:4px;">其它帐号登录：</div></div><div style=" float:left ; width:70px;"><img onclick="toSNSLogin(&#39;smb&#39;);wzhitnew(47);" style="cursor:pointer;" src="./Android之SurfaceView详解_files/tb25.gif">&nbsp;&nbsp;&nbsp;<img onclick="toSNSLogin(&#39;qq&#39;);wzhitnew(48);" style="cursor:pointer;" src="./Android之SurfaceView详解_files/tb26.gif">&nbsp;&nbsp;&nbsp;<img onclick="toSNSLogin(&#39;rr&#39;);wzhitnew(49);" style="cursor:pointer;" src="./Android之SurfaceView详解_files/tb27.gif"></div> </div> </div></div></div></div>
                            </div>
                        </div>
                    </td>
                    <td align="center" valign="top" width="18px"></td>
                    <td align="left" valign="top" width="252px">
                        


<div style="height: 98px" id="artrightad1"><iframe marginwidth="0" id="Iframeadabtest" marginheight="0" frameborder="0" scrolling="no" width="300" height="90" src="./Android之SurfaceView详解_files/ad1_300.htm" allowtransparency="true"></iframe></div>


    <div id="artrightnewarticle" class="remenwz" style="height: 219px; width: 300px;"><div class="rementop"><div class="titwx" style=" padding-top:10px; padding-left:24px;">最新文章</div></div><div class="modlist3 list" style=" padding-left:15px;"><ul><li><span><a href="http://www.360doc.com/content/13/0725/22/11818366_302489243.shtml" target="_blank" onclick="wzhitnew(51)">Dalvik虚拟机的启动过程分析</a></span></li><li><span><a href="http://www.360doc.com/content/13/0422/20/7724936_280192273.shtml" target="_blank" onclick="wzhitnew(51)">android activity的叠加启动</a></span></li><li><span><a href="http://www.360doc.com/content/13/0326/11/7724936_273987790.shtml" target="_blank" onclick="wzhitnew(51)">adb命令总结2</a></span></li><li><span><a href="http://www.360doc.com/content/13/0325/11/7724936_273779235.shtml" target="_blank" onclick="wzhitnew(51)">c语言强制转换</a></span></li><li><span><a href="http://www.360doc.com/content/13/0325/11/7724936_273778670.shtml" target="_blank" onclick="wzhitnew(51)">C语言运算符优先级 详细列表</a></span></li><li><span><a href="http://www.360doc.com/content/13/0321/17/7724936_273045792.shtml" target="_blank" onclick="wzhitnew(51)">mediaplayer 类</a></span></li></ul> <div class=" rt360" style=" padding-right:23px;"><a href="http://www.360doc.com/userhome/7724936" target="_blank" onclick="wzhitnew(52);">更多</a></div></div></div>


<div class="both" style="padding-top: 10px; height: 260px;">
   <iframe id="ifartad1" height="250px" width="300px" frameborder="0" scrolling="no" src="./Android之SurfaceView详解_files/ad2_300.htm"></iframe>
    <div style="height: 10px;">
    </div>
</div>

<div class="remenwz" id="artrighthotarticle" style="width: 300px;">
    <div class="rementop">
        <div class="titwx" style="padding-top: 10px; padding-left: 24px;">
            热门文章</div>
    </div>
    <div class="modlist3 list" style="padding-left: 15px;">
        <ul>
            
                    <li><span>
                        <a href="http://www.360doc.com/content/14/1004/14/4917028_414336250.shtml" target="_blank" onclick="wzhitnew(55)">火凤凰【极品美图】</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0508/03/4240596_375676165.shtml" target="_blank" onclick="wzhitnew(55)">魏碑间架结构九十二法</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0912/02/7858166_408804502.shtml" target="_blank" onclick="wzhitnew(55)">草书对照表（有空就看看吧）</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/15/0105/23/17132703_438490371.shtml" target="_blank" onclick="wzhitnew(55)">2014年度各种十大影片最全榜单</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0628/21/17132703_390589768.shtml" target="_blank" onclick="wzhitnew(55)">9部开着灯才敢看的惊悚电影！吓死人了...</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0409/16/15952372_367543490.shtml" target="_blank" onclick="wzhitnew(55)">手机变成扫描仪(必备自制手机拍摄支架)</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/1218/20/20308986_433975816.shtml" target="_blank" onclick="wzhitnew(55)">一生中最后的存折是老伴，唯有一人爱...</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0909/18/14102128_408219401.shtml" target="_blank" onclick="wzhitnew(55)">150部让人回味的电影陈列，拿去收藏！</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0206/13/1093078_350167301.shtml" target="_blank" onclick="wzhitnew(55)">家装设计的度——八藏八露</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0329/15/3256622_364697453.shtml" target="_blank" onclick="wzhitnew(55)">真的出大事了，2014房价大崩盘了，有...</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/14/0514/10/7707294_377465663.shtml" target="_blank" onclick="wzhitnew(55)">【如果我只有一点点喜欢你】</a></span></li>
                
                    <li><span>
                        <a href="http://www.360doc.com/content/13/1209/17/10106911_335754584.shtml" target="_blank" onclick="wzhitnew(55)">好孩子是“暗示”出来的</a></span></li>
                
        </ul>
        <div class=" rt360" style="padding-right: 23px;">
            <a href="http://www.360doc.com/readroom.html" target="_blank" onclick="wzhitnew(56)">更多&gt;&gt;</a></div>
    </div>
</div>

<div class="both" style="padding-top: 10px;">
    <iframe id="ifartad2" height="250px" width="300px" frameborder="0" scrolling="no" src="./Android之SurfaceView详解_files/ad3_300.htm"></iframe>
</div>
<br>


 <iframe id="ifartrightsogou" height="328px" width="300px" frameborder="0" scrolling="no" src="./Android之SurfaceView详解_files/artrightadsogou300.htm"></iframe>



<script>
    function change(pro_name, i) {
        var pro = document.getElementById(pro_name); 
        var pro_arr = pro.getElementsByTagName("span");

        for (var m = 0; m < pro_arr.length; m++) {
            pro_arr[m].className = "unclecked link_black";
        }
        pro_arr[i].className = "checked link_bai";

        if (i == 1) {
            document.getElementById("qh_ul_1").style.display = "";
            document.getElementById("qh_ul_0").style.display = "none";
        }
        else if (i == 0) {
            document.getElementById("qh_ul_1").style.display = "none";
            document.getElementById("qh_ul_0").style.display = "";
        }
    }
</script>

                        <div class="both" id="divad5" style="padding-top: 11px; zoom: 1; top: 55px; left: 1128.5px;">
                            <div id="divad4" style="">
                                <div>
                                    <iframe id="ifartad" height="250px" width="300px" frameborder="0" scrolling="no" src="./Android之SurfaceView详解_files/ad4_300.htm"></iframe>
                                </div>
                                <div class="ggwz">
                                    <a href="javascript:void(0);" onclick="closead(2);">关闭</a>
                                </div>
                                <div style="height: 13px;">
                                </div>
                            </div>
                            <div style="clear: both;" id="divad6">
                                <div id="adfloatbaidu">
                                    <iframe id="ifartadfloadbaidu" height="250px" width="300px" frameborder="0" scrolling="no" src="./Android之SurfaceView详解_files/ad5_300.htm"></iframe>
                                </div>
                                <div class="ggwz">
                                    <a href="javascript:void(0);" onclick="closead(3);">关闭</a>
                                </div>
                                <div style="height: 13px;">
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <input type="hidden" id="docarttitle" value="Android%e4%b9%8bSurfaceView%e8%af%a6%e8%a7%a3">
    <input type="hidden" id="artreadroomid" value="0">
    <script>var asw='surfaceview+surfaceholder+surface'</script>
    <div id="docdiviframe"></div>


    <script language="javascript" type="text/javascript">
        var appName = navigator.appName.toLowerCase();
        if (appName.indexOf("microsoft internet explorer") > -1) {
            document.write("<scr" + "ipt type='text/javascript' src='http://www.360doc.com/js/StickySystemIE20130911.js?t=2015041601'></sc" + "ript>");
        }
        else {

            document.write("<scr" + "ipt type='text/javascript' src='http://www.360doc.com/js/StickySystemOther20130911.js?t=2015041601'></sc" + "ript>");
        }
    </script><script type="text/javascript" src="./Android之SurfaceView详解_files/StickySystemOther20130911.js"></script>

    <script>GerLookingUserInfo(1,7724936,1,1,'-1',-1,10,0);OutputSource('http%3a%2f%2fwww.360doc.com%2fuserhome%2f7724936');OutputCategory(7724936,44,'%e3%80%8aSurfaceview%e3%80%8b');</script>

    <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fd86954201130d615136257dde062a503' type='text/javascript'%3E%3C/script%3E"));
    </script><script src="./Android之SurfaceView详解_files/h.js" type="text/javascript"></script>

    <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6857724" src="./Android之SurfaceView详解_files/bds_s_v2.js"></script>

    <script type="text/javascript">
        document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date() / 3600000);
    </script>
    <!-- Baidu Button END -->
    <script src="./Android之SurfaceView详解_files/logger.js"></script>




<div id="goTop2" style="left: 1470px; display: block;"><div id="goTop"><a href="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml#" id="go_top"></a></div><div id="goTop1"><a href="javascript:void(0);" id="go_top1"></a></div><div><div id="artweixinDiv" style="position: relative;display:none;"><div style="position: absolute; z-index: 2001;margin-left:-220px;*margin-left:-244px;!important;margin-top:-34px;*margin-top:-134px;!important;"><img src="./Android之SurfaceView详解_files/wzweixin.gif"></div></div><div id="goTop3" onmouseover="document.getElementById(&#39;artweixinDiv&#39;).style.display=&#39;&#39;;" onmouseout="document.getElementById(&#39;artweixinDiv&#39;).style.display=&#39;none&#39;;"><a href="javascript:void(0);" id="go_top3"></a></div></div></div><div style="display: none;"><iframe width="1" height="1" src="javascript:document.write('');" id="UploadContentIframe" name="UploadContentIframe"></iframe></div><div style="display: none;"><form id="UploadContentForm" name="UploadContentForm" action="./Android之SurfaceView详解_files/log_print.htm" target="UploadContentIframe" enctype="application/x-www-form-urlencoded" method="POST"><input type="text" name="url" value="http://www.360doc.com/content/13/0103/14/7724936_257842268.shtml"><textarea name="title">Android之SurfaceView详解</textarea><textarea name="mypos"></textarea><textarea name="metakeywords">surfaceview,surfaceholder,surface</textarea><textarea name="metadescription">Android之SurfaceView详解</textarea><input type="text" name="lastmodified" value="05/21/2015 03:04:17"><input type="text" name="charset" value="UTF-8"><textarea name="maincontent">SurfaceView介绍通常情况程序的View和用户响应都是在同一个线程中处理的，这也是为什么处理长时间事件（例如访问网络）需要放到另外的线程中去（防止阻塞当前UI线程的操作和绘制）。但是在其他线程中却不能修改UI元素，例如用后台线程更新自定义View（调用View的在自定义View中的onDraw函数）是不允许的。 如果需要在另外的线程绘制界面、需要迅速的更新界面或则渲染UI界面需要较长的时间，这种情况就要使用SurfaceView了。SurfaceView中包含一个Surface对象，而Surface是可以在后台线程中绘制的。Surface属于 OPhone底层显示系统。SurfaceView的性质决定了其比较适合一些场景：需要界面迅速更新、对帧率要求较高的情况。使用SurfaceView需要注意以下几点情况： SurfaceView和SurfaceHolder.Callback函数都从当前SurfaceView窗口线程中调用（一般而言就是程序的主线程）。有关资源状态要注意和绘制线程之间的同步。 在绘制线程中必须先合法的获取Surface才能开始绘制内容，在SurfaceHolder.Callback.surfaceCreated() 和SurfaceHolder.Callback.surfaceDestroyed()之间的状态为合法的，另外在Surface类型为SURFACE_TYPE_PUSH_BUFFERS时候是不合法的。 额外的绘制线程会消耗系统的资源，在使用SurfaceView的时候要注意这点。 使用SurfaceView 只要继承SurfaceView类并实现SurfaceHolder.Callback接口就可以实现一个自定义的SurfaceView了，SurfaceHolder.Callback在底层的Surface状态发生变化的时候通知View，SurfaceHolder.Callback具有如下的接口： surfaceCreated(SurfaceHolder holder)：当Surface第一次创建后会立即调用该函数。程序可以在该函数中做些和绘制界面相关的初始化工作，一般情况下都是在另外的线程来绘制界面，所以不要在这个函数中绘制Surface。 surfaceChanged(SurfaceHolder holder, int format, int width,int height)：当Surface的状态（大小和格式）发生变化的时候会调用该函数，在surfaceCreated调用后该函数至少会被调用一次。 surfaceDestroyed(SurfaceHolder holder)：当Surface被摧毁前会调用该函数，该函数被调用后就不能继续使用Surface了，一般在该函数中来清理使用的资源。 通过SurfaceView的getHolder()函数可以获取SurfaceHolder对象，Surface 就在SurfaceHolder对象内。虽然Surface保存了当前窗口的像素数据，但是在使用过程中是不直接和Surface打交道的，由SurfaceHolder的Canvas lockCanvas()或则Canvas lockCanvas(Rect dirty)函数来获取Canvas对象，通过在Canvas上绘制内容来修改Surface中的数据。如果Surface不可编辑或则尚未创建调用该函数会返回null，在 unlockCanvas() 和 lockCanvas()中Surface的内容是不缓存的，所以需要完全重绘Surface的内容，为了提高效率只重绘变化的部分则可以调用lockCanvas(Rect dirty)函数来指定一个dirty区域，这样该区域外的内容会缓存起来。在调用lockCanvas函数获取Canvas后，SurfaceView会获取Surface的一个同步锁直到调用unlockCanvasAndPost(Canvas canvas)函数才释放该锁，这里的同步机制保证在Surface绘制过程中不会被改变（被摧毁、修改）。当在Canvas中绘制完成后，调用函数unlockCanvasAndPost(Canvas canvas)来通知系统Surface已经绘制完成，这样系统会把绘制完的内容显示出来。为了充分利用不同平台的资源，发挥平台的最优效果可以通过SurfaceHolder的setType函数来设置绘制的类型，目前接收如下的参数： SURFACE_TYPE_NORMAL：用RAM缓存原生数据的普通Surface SURFACE_TYPE_HARDWARE：适用于DMA(Direct memory access )引擎和硬件加速的Surface SURFACE_TYPE_GPU：适用于GPU加速的Surface SURFACE_TYPE_PUSH_BUFFERS：表明该Surface不包含原生数据，Surface用到的数据由其他对象提供，在Camera图像预览中就使用该类型的Surface，有Camera负责提供给预览Surface数据，这样图像预览会比较流畅。如果设置这种类型则就不能调用lockCanvas来获取Canvas对象了。 使用的SurfaceView的时候，一般情况下还要对其进行创建，销毁，改变时的情况进行监视，这就要用到SurfaceHolder.Callback.只要继承SurfaceView类并实现SurfaceHolder.Callback接口就可以实现一个自定义的SurfaceView了，SurfaceHolder.Callback在底层的Surface状态发生变化的时候通知View，SurfaceHolder.Callback具有如下的接口：surfaceCreated(SurfaceHolder holder)：当Surface第一次创建后会立即调用该函数。程序可以在该函数中做些和绘制界面相关的初始化工作，一般情况下都是在另外的线程来绘制界面，所以不要在这个函数中绘制Surface。 surfaceChanged(SurfaceHolder holder, int format, int width,int height)：当Surface的状态（大小和格式）发生变化的时候会调用该函数，在surfaceCreated调用后该函数至少会被调用一次。 surfaceDestroyed(SurfaceHolder holder)：当Surface被摧毁前会调用该函数，该函数被调用后就不能继续使用Surface了，一般在该函数中来清理使用的资源。 通过SurfaceView的getHolder()函数可以获取SurfaceHolder对象，Surface 就在SurfaceHolder对象内。虽然Surface保存了当前窗口的像素数据，但是在使用过程中是不直接和Surface打交道的，由SurfaceHolder的Canvas lockCanvas()或则Canvas lockCanvas(Rect dirty)函数来获取Canvas对象，通过在Canvas上绘制内容来修改Surface中的数据。如果Surface不可编辑或则尚未创建调用该函数会返回null，在 unlockCanvas() 和 lockCanvas()中Surface的内容是不缓存的，所以需要完全重绘Surface的内容，为了提高效率只重绘变化的部分则可以调用lockCanvas(Rect dirty)函数来指定一个dirty区域，这样该区域外的内容会缓存起来。在调用lockCanvas函数获取Canvas后，SurfaceView会获取Surface的一个同步锁直到调用unlockCanvasAndPost(Canvas canvas)函数才释放该锁，这里的同步机制保证在Surface绘制过程中不会被改变（被摧毁、修改）。当在Canvas中绘制完成后，调用函数unlockCanvasAndPost(Canvas canvas)来通知系统Surface已经绘制完成，这样系统会把绘制完的内容显示出来。为了充分利用不同平台的资源，发挥平台的最优效果可以通过SurfaceHolder的setType函数来设置绘制的类型，目前接收如下的参数：SURFACE_TYPE_NORMAL：用RAM缓存原生数据的普通Surface SURFACE_TYPE_HARDWARE：适用于DMA(Direct memory access )引擎和硬件加速的Surface SURFACE_TYPE_GPU：适用于GPU加速的Surface SURFACE_TYPE_PUSH_BUFFERS：表明该Surface不包含原生数据，Surface用到的数据由其他对象提供，在Camera图像预览中就使用该类型的Surface，有Camera负责提供给预览Surface数据，这样图像预览会比较流畅。如果设置这种类型则就不能调用lockCanvas来获取Canvas对象了。 访问SurfaceView的底层图形是通过SurfaceHolder接口来实现的，通过getHolder()方法可以得到这个SurfaceHolder对象。你应该实现surfaceCreated(SurfaceHolder)和surfaceDestroyed(SurfaceHolder)方法来知道在这个Surface在窗口的显示和隐藏过程中是什么时候创建和销毁的。注意：一个SurfaceView只在SurfaceHolder.Callback.surfaceCreated() 和 SurfaceHolder.Callback.surfaceDestroyed()调用之间是可用的，其他时间是得不到它的Canvas对象的（null）。SurfaceView和View最本质的区别SurfaceView和View最本质的区别在于，surfaceView是在一个新起的单独线程中可以重新绘制画面而View必须在UI的主线程中更新画面。那么在UI的主线程中更新画面 可能会引发问题，比如你更新画面的时间过长，那么你的主UI线程会被你正在画的函数阻塞。那么将无法响应按键，触屏等消息。当使用surfaceView 由于是在新的线程中更新画面所以不会阻塞你的UI主线程。但这也带来了另外一个问题，就是事件同步。比如你触屏了一下，你需要surfaceView中thread处理，一般就需要有一个event queue的设计来保存touch event，这会稍稍复杂一点，因为涉及到线程同步。所以基于以上，根据游戏特点，一般分成两类。1 被动更新画面的。比如棋类，这种用view就好了。因为画面的更新是依赖于 onTouch 来更新，可以直接使用 invalidate。 因为这种情况下，这一次Touch和下一次的Touch需要的时间比较长些，不会产生影响。2 主动更新。比如一个人在一直跑动。这就需要一个单独的thread不停的重绘人的状态，避免阻塞main UI thread。所以显然view不合适，需要surfaceView来控制。周末看《精通Android游戏开发》(Pro Android Games)，里面讲到游戏的框架，其中一个重要的概念surfaceview,觉得不是很理解，于是花了一点时间研究了下，写下自己的心得。surface，这个单词的意思是浮在表面的，那么surfaceview就是浮在表面的view了。如果真的这样解释，估计有人要拍砖了。然而，话虽不能这么说，取这个名儿，多少还是有点关系的。surface是一个可见区域。我们在屏幕上看到的这些view，在屏幕上看到的就是画面，在内存中就是一块内存区。绘图的时候，就是显示的硬件如显卡将内存区的这块图形数据绘制到屏幕上。所以，从内存的角度去看这些东西，会比较好理解。surface是surfaceview中的一个可见部分。我们知道，我们看到的屏幕上的图形，是二维的，我们看到的就是长和宽，其实，在内部实际上是三维的，另一个维度，就是层layer。我们用visio绘图，都会看到这种情况，一个图形会将另个图形遮住，是因为这个图形在上层。如果有同AutoCAD的经验，对这个更容易理解。我们看到的图形实际上是很多图形一层层的叠加在一起的，这些图形元素完全不可见，或者部分可见部分不可见，或者完全可见。这样看来，surface就可以这样理解：它是内存中一块区域，它是surfaceview可见不那个部分，绘图操作作用于它，然后它就会被显卡之类的显示控制器绘制到屏幕上。surface是个啥，大概已经有了些概念了。因为它对应了一个内存区，大家都知道，内存区的对象是有生命周期的，可以动态的申请创建和销毁，当然也可能会更新。于是，就有了作用于这个内存区的操作，这些操作就是surfaceCreated/Changed/Destroyed。三个操作放在一起，就是callback,所以在很多例子里看到，会有callback。callback,是回调，意思是自己能干一些活，不过自己不去主动做，而是到别人那里去登记一下，别人需要的时候，就会叫我去做。就这个例子而言，可以打这个比方，某建筑工人队伍A，能盖房子，能装修，也能拆房子。可是他自己不去主动的做这些事情，而是去向开发商B去登记这三种能力，当然了，他把这三种能力打了包，叫做A的能力。啥时候，B有活干了，就叫A去做，或者是盖房子，或者是装修，或者是拆建筑。在这个例子中，能力包就是callback.说了这个例子，其实就解释了 surface相关的一些东西，callback已经说过了，下面来说说其他的。假设surface就是一栋房子，那么surface拥有surfaceHolder，谁呢？在这个例子中好比建筑队A。盖房子对应的就是surfaceCreated, 拆房子就对应了surfaceDestroyed，装修就对应了surfaceChanged.surface有生存期，好比房子有生存期，在建造以后就存在，在拆了之后就没有了。装修必须发生在这之间。同样的，surface的change必须发生在created和destroyed之间。surfaceview知道surface的holder是谁，在surfaceview生成的时候，会调用getHolder得到holder，然后holder会调用addCallback将三个callback函数注册。holder拥有对于surface的控制权。在很多程序中，会在surfaceCreated的函数实现中创建另一个线程。所以在这里有两个线程，一个是UI线程，另一个负责画图的线程。画图线程由UI线程调用surfaceCreated的时候创建，在surfaceDestroyed调用的时候放回到线程池。在这中间，画图线程负责图形的绘制。在这种模型下，UI线程和画图线程各司其职，前者主要负责和用户的交互，而后者，在负责绘制图形。这样，绘制图形的时候如果时间较长，不会阻塞用户的输入。我们知道，线程共享内存数据，所以， surface对于两个线程是共享的。所以，为了避免在画图的时候，UI线程也对surface进行操作，在画图前，需要对surface加锁。这个工作是有holder干的，holder会先锁住surface中的一块holder.lockCanvas，我们叫canvas,然后，在上面绘画，画完之后，会解锁unlockCanvasAndPost。在 应用中，画图可以是一次性的，也可以是由定时器触发的定时的画。实现的都是runnable类中的run方法。关于runnable类，这个Java中定义的，并不是android独有的，可以参考Java的referrence.这个模型最大的好处就是，画图不依赖于UI线程，不会阻塞UI线程。而单纯的view是依赖于UI线程画图的。对于完全依赖于用户的输入进行图像显示的更新的，用view是可以的，但是如果能够自动的进行绘图，而不需等待用户的输入，surfaceview无疑是更好的选择。有图有真相，请看图在android中开发游戏，一般来说，或想写一个复杂一点的游戏，是必须用到SurfaceView来开发的。经过这一阵子对android的学习，我找到了自已在android中游戏开发的误区，不要老想着用Layout和view去实现，不要将某个游戏中的对象做成一个组件来处理。应该尽量想着在Canvas(画布)中画出游戏戏中的背景、人物、动画等...SurfaceView提供直接访问一个可画图的界面，可以控制在界面顶部的子视图层。SurfaceView是提供给需要直接画像素而不是使用窗体部件的应用使用的。Android图形系统中一个重要的概念和线索是surface。View及其子类（如TextView, Button）要画在surface上。每个surface创建一个Canvas对象（但属性时常改变），用来管理view在surface上的绘图操作，如画点画线。还要注意的是，使用它的时候，一般都是出现在最顶层的：The view hierarchy will take care of correctly compositingwith the Surface any siblings of the SurfaceView that would normally appear on top of it.使用的SurfaceView的时候，一般情况下还要对其进行创建，销毁，改变时的情况进行监视，这就要用到SurfaceHolder.Callback.class BBatt extends SurfaceView implements SurfaceHolder.Callback {public void surfaceChanged(SurfaceHolder holder,int format,int width,int height){}//看其名知其义，在surface的大小发生改变时激发public void surfaceCreated(SurfaceHolder holder){}//同上，在创建时激发，一般在这里调用画图的线程。public void surfaceDestroyed(SurfaceHolder holder) {}//同上，销毁时激发，一般在这里将画图的线程停止、释放。}例子：public class BBatt extends SurfaceView implementsSurfaceHolder.Callback, OnKeyListener {private BFairy bFairy;private DrawThread drawThread;public BBatt(Context context) {super(context);this.setLayoutParams(new ViewGroup.LayoutParams(Global.battlefieldWidth, Global.battlefieldHeight));this.getHolder().addCallback( this );this.setFocusable( true );this.setOnKeyListener( this );bFairy = new BFairy(this.getContext());}public void surfaceChanged(SurfaceHolder holder,int format,int width,int height) {drawThread = new DrawThread(holder);drawThread.start();}public void surfaceDestroyed(SurfaceHolder holder) {if( drawThread != null ) {drawThread.doStop();while (true) try {drawThread.join();break ;} catch(Exception ex) {}}}public boolean onKey(View view, int keyCode, KeyEvent event) {}}实例2:用线程画一个蓝色的长方形。package com.g3.test;/** SurfaceView的示例程序* 演示其流程*/import android.app.Activity;import android.content.Context;import android.graphics.Canvas;import android.graphics.Color;import android.graphics.Paint;import android.graphics.RectF;import android.os.Bundle;import android.view.SurfaceHolder;import android.view.SurfaceView;public class Test extends Activity {public void onCreate(Bundle savedInstanceState) {super.onCreate(savedInstanceState);setContentView(new MyView(this));}//内部类class MyView extends SurfaceView implements SurfaceHolder.Callback{SurfaceHolder holder;public MyView(Context context) {super(context);holder = this.getHolder();//获取holderholder.addCallback(this);//setFocusable(true);}@Overridepublic void surfaceChanged(SurfaceHolder holder, int format, int width,int height) {}@Overridepublic void surfaceCreated(SurfaceHolder holder) {new Thread(new MyThread()).start();}@Overridepublic void surfaceDestroyed(SurfaceHolder holder) {}//内部类的内部类class MyThread implements Runnable{@Overridepublic void run() {Canvas canvas = holder.lockCanvas(null);//获取画布Paint mPaint = new Paint();mPaint.setColor(Color.BLUE);canvas.drawRect(new RectF(40,60,80,80), mPaint);holder.unlockCanvasAndPost(canvas);//解锁画布，提交画好的图像}}}}访问SurfaceView的底层图形是通过SurfaceHolder接口来实现的，通过getHolder()方法可以得到这个SurfaceHolder对象。你应该实现surfaceCreated(SurfaceHolder)和surfaceDestroyed(SurfaceHolder)方法来知道在这个Surface在窗口的显示和隐藏过程中是什么时候创建和销毁的。SurfaceView可以在多线程中被访问。注意：一个SurfaceView只在SurfaceHolder.Callback.surfaceCreated() 和 SurfaceHolder.Callback.surfaceDestroyed()调用之间是可用的，其他时间是得不到它的Canvas对象的（null）。我的访问过程：创建一个SurfaceView的子类，实现SurfaceHolder.Callback接口。得到这个SurfaceView的SurfaceHolder对象holder。holder.addCallback(callback)，也就是实现SurfaceHolder.Callback接口的类对象。在SurfaceHolder.Callback.surfaceCreated()调用过后holder.lockCanvas()对象就可以得到SurfaceView对象对应的Canvas对象canvas了。用canvas对象画图。画图结束后调用holder.unlockCanvasAndPost()就把图画在窗口中了。SurfaceView可以多线程访问，在多线程中画图。import android.content.Context;import android.graphics.Canvas;import android.graphics.Color;import android.graphics.Paint;import android.util.Log;import android.view.SurfaceHolder;import android.view.SurfaceView;public class MySurfaceView extends SurfaceView implementsSurfaceHolder.Callback {private Context mContext;private SurfaceHolder mHolder;public TouchScreenAdjusterSurfaceView(Context context,) {super(context);mContext = context;mHolder = TouchScreenAdjusterSurfaceView.this.getHolder();mHolder.addCallback(TouchScreenAdjusterSurfaceView.this);this.setFocusableInTouchMode(true); // to make sure that we can get// touch events and key events,and// "setFocusable()" to make sure we// can get key events}@Overridepublic void surfaceChanged(SurfaceHolder holder, int format, int width,int height) {// TODO Auto-generated method stub}@Overridepublic void surfaceCreated(SurfaceHolder holder) {//now you can get the Canvas and draw something here}@Overridepublic void surfaceDestroyed(SurfaceHolder holder) {// TODO Auto-generated method stub}public void drawMyShape(PointPostion ps) {mCanvas = mHolder.lockCanvas();// draw anything you likemHolder.unlockCanvasAndPost(mCanvas);}如何让 SurfaceView 响应事件当然创建你自己的类时，你还是得extends SurfaceView and implements Callback接口，然后在构造函数里设置一个属性this.setLongClickable(true);//这里很重要，它是让你的设备支持长按效果的属性，如果它为false 的时候MotionEvent 只能监听到ACTION_DOWN这个事件。上面准备好后就可以重写 onTouchEvent方法了！！@Overridepublic boolean onTouchEvent(MotionEvent event){switch(event.getAction()){case MotionEvent.ACTION_DOWN:Log.d("MotionEvent", "ACTION_DOWN");break;case MotionEvent.ACTION_UP:Log.d("MotionEvent", "ACTION_UP");break;case MotionEvent.ACTION_MOVE:Log.d("MotionEvent", "ACTION_MOVE");break;}return super.onTouchEvent(event);}调试一下看看吧！！</textarea></form></div></body></html>